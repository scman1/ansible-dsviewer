---
- name: ping hosts
  hosts: all

  tasks:
    - ping: ~

- name: install nginx
  hosts: local
  become: true
  
  tasks:
    - name: install ruby
      apt:
        name: ruby
        state: latest

#    - name: Add node.js 10 repostory
#     command: curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -
    - name: install dependencies for ruby and nodejs package
      action: 'apt pkg={{item}} state=present'
      with_items: 
        - git-core
        - curl 
        - zlib1g-dev
        - build-essential
        - libssl-dev
        - libreadline-dev
        - libyaml-dev
        - libxml2-dev
        - libxslt1-dev
        - libcurl4-openssl-dev
        - software-properties-common
        - libffi-dev
        - dirmngr
        - gnupg
        - apt-transport-https
        - ca-certificates
        - redis-server
        - redis-tools
        - nodejs
        - yarn
        - ruby
        - ruby-dev
        - ri
        - git               #to download portal source code
        - python-mysqldb    #required for ansible mysql modules
